/*! For license information please see index.js.LICENSE.txt */
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var $=_interopDefault(require("jquery"));function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},_extends.apply(this,arguments)}var Util=function(e){var t="transitionend",n={TRANSITION_END:"mmTransitionEnd",triggerTransitionEnd:function(n){e(n).trigger(t)},supportsTransitionEnd:function(){return Boolean(t)}};return e.fn.mmEmulateTransitionEnd=function(t){var i=this,a=!1;return e(this).one(n.TRANSITION_END,(function(){a=!0})),setTimeout((function(){a||n.triggerTransitionEnd(i)}),t),this},e.event.special[n.TRANSITION_END]={bindType:t,delegateType:t,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}},n}($),NAME="metisMenu",DATA_KEY="metisMenu",EVENT_KEY="."+DATA_KEY,DATA_API_KEY=".data-api",JQUERY_NO_CONFLICT=$.fn[NAME],TRANSITION_DURATION=350,Default={toggle:!0,preventDefault:!0,triggerElement:"a",parentTrigger:"li",subMenu:"ul"},Event={SHOW:"show"+EVENT_KEY,SHOWN:"shown"+EVENT_KEY,HIDE:"hide"+EVENT_KEY,HIDDEN:"hidden"+EVENT_KEY,CLICK_DATA_API:"click"+EVENT_KEY+DATA_API_KEY},ClassName={METIS:"metismenu",ACTIVE:"mm-active",SHOW:"mm-show",COLLAPSE:"mm-collapse",COLLAPSING:"mm-collapsing",COLLAPSED:"mm-collapsed"},MetisMenu=function(){function e(e,t){this.element=e,this.config=_extends({},Default,{},t),this.transitioning=null,this.init()}var t=e.prototype;return t.init=function(){var e=this,t=this.config,n=$(this.element);n.addClass(ClassName.METIS),n.find(t.parentTrigger+"."+ClassName.ACTIVE).children(t.triggerElement).attr("aria-expanded","true"),n.find(t.parentTrigger+"."+ClassName.ACTIVE).parents(t.parentTrigger).addClass(ClassName.ACTIVE),n.find(t.parentTrigger+"."+ClassName.ACTIVE).parents(t.parentTrigger).children(t.triggerElement).attr("aria-expanded","true"),n.find(t.parentTrigger+"."+ClassName.ACTIVE).has(t.subMenu).children(t.subMenu).addClass(ClassName.COLLAPSE+" "+ClassName.SHOW),n.find(t.parentTrigger).not("."+ClassName.ACTIVE).has(t.subMenu).children(t.subMenu).addClass(ClassName.COLLAPSE),n.find(t.parentTrigger).children(t.triggerElement).on(Event.CLICK_DATA_API,(function(n){var i=$(this);if("true"!==i.attr("aria-disabled")){t.preventDefault&&"#"===i.attr("href")&&n.preventDefault();var a=i.parent(t.parentTrigger),s=a.siblings(t.parentTrigger),r=s.children(t.triggerElement);a.hasClass(ClassName.ACTIVE)?(i.attr("aria-expanded","false"),e.removeActive(a)):(i.attr("aria-expanded","true"),e.setActive(a),t.toggle&&(e.removeActive(s),r.attr("aria-expanded","false"))),t.onTransitionStart&&t.onTransitionStart(n)}}))},t.setActive=function(e){$(e).addClass(ClassName.ACTIVE);var t=$(e).children(this.config.subMenu);t.length>0&&!t.hasClass(ClassName.SHOW)&&this.show(t)},t.removeActive=function(e){$(e).removeClass(ClassName.ACTIVE);var t=$(e).children(this.config.subMenu+"."+ClassName.SHOW);t.length>0&&this.hide(t)},t.show=function(e){var t=this;if(!this.transitioning&&!$(e).hasClass(ClassName.COLLAPSING)){var n=$(e),i=$.Event(Event.SHOW);if(n.trigger(i),!i.isDefaultPrevented()){if(n.parent(this.config.parentTrigger).addClass(ClassName.ACTIVE),this.config.toggle){var a=n.parent(this.config.parentTrigger).siblings().children(this.config.subMenu+"."+ClassName.SHOW);this.hide(a)}n.removeClass(ClassName.COLLAPSE).addClass(ClassName.COLLAPSING).height(0),this.setTransitioning(!0),n.height(e[0].scrollHeight).one(Util.TRANSITION_END,(function(){t.config&&t.element&&(n.removeClass(ClassName.COLLAPSING).addClass(ClassName.COLLAPSE+" "+ClassName.SHOW).height(""),t.setTransitioning(!1),n.trigger(Event.SHOWN))})).mmEmulateTransitionEnd(TRANSITION_DURATION)}}},t.hide=function(e){var t=this;if(!this.transitioning&&$(e).hasClass(ClassName.SHOW)){var n=$(e),i=$.Event(Event.HIDE);if(n.trigger(i),!i.isDefaultPrevented()){n.parent(this.config.parentTrigger).removeClass(ClassName.ACTIVE),n.height(n.height())[0].offsetHeight,n.addClass(ClassName.COLLAPSING).removeClass(ClassName.COLLAPSE).removeClass(ClassName.SHOW),this.setTransitioning(!0);var a=function(){t.config&&t.element&&(t.transitioning&&t.config.onTransitionEnd&&t.config.onTransitionEnd(),t.setTransitioning(!1),n.trigger(Event.HIDDEN),n.removeClass(ClassName.COLLAPSING).addClass(ClassName.COLLAPSE))};0===n.height()||"none"===n.css("display")?a():n.height(0).one(Util.TRANSITION_END,a).mmEmulateTransitionEnd(TRANSITION_DURATION)}}},t.setTransitioning=function(e){this.transitioning=e},t.dispose=function(){$.removeData(this.element,DATA_KEY),$(this.element).find(this.config.parentTrigger).children(this.config.triggerElement).off(Event.CLICK_DATA_API),this.transitioning=null,this.config=null,this.element=null},e.jQueryInterface=function(t){return this.each((function(){var n=$(this),i=n.data(DATA_KEY),a=_extends({},Default,{},n.data(),{},"object"==typeof t&&t?t:{});if(i||(i=new e(this,a),n.data(DATA_KEY,i)),"string"==typeof t){if(void 0===i[t])throw new Error('No method named "'+t+'"');i[t]()}}))},e}();$.fn[NAME]=MetisMenu.jQueryInterface,$.fn[NAME].Constructor=MetisMenu,$.fn[NAME].noConflict=function(){return $.fn[NAME]=JQUERY_NO_CONFLICT,MetisMenu.jQueryInterface},module.exports=MetisMenu;